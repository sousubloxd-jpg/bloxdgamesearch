<!DOCTYPE html>
<html>
<head>
    <title>Bloxd Top 10 Leaderboard</title>
    <style>
        body { font-family: sans-serif; background: #111; color: #fff; text-align: center; padding: 20px; }
        table { margin: 20px auto; border-collapse: collapse; width: 95%; max-width: 800px; background: #222; border: 2px solid #444; }
        th, td { padding: 12px; border: 1px solid #444; text-align: left; }
        th { background: #333; color: #00ccff; }
        .ccu { color: #00ff00; font-weight: bold; }
    </style>
</head>
<body>
    <h1>üèÜ Bloxd.io Live Top 10</h1>
    <div id="leaderboard">Attempting to bypass blocks...</div>

    <script>
        async function updateLeaderboard() {
            const bloxdApi = "https://social26.bloxd.io";
            
            // List of proxies to rotate through if one fails
            const proxies = [
                "https://api.allorigins.win",
                "https://api.codetabs.com",
                "https://thingproxy.freeboard.io"
            ];

            for (let proxy of proxies) {
                try {
                    const finalUrl = proxy + encodeURIComponent(bloxdApi);
                    const response = await fetch(finalUrl);
                    
                    if (!response.ok) continue; // Try next proxy if 520/522 error

                    const text = await response.text();
                    
                    // If it's AllOrigins, we need to extract .contents
                    let jsonData;
                    if (proxy.includes("allorigins")) {
                        const wrapper = JSON.parse(text);
                        jsonData = JSON.parse(wrapper.contents);
                    } else {
                        jsonData = JSON.parse(text);
                    }

                    // Use the 'results' field from your Network Tab discovery
                    const games = jsonData.results || [];
                    games.sort((a, b) => (b.ccu || 0) - (a.ccu || 0));

                    const top10 = games.slice(0, 10);
                    let html = "<table><tr><th>Rank</th><th>Game Name</th><th>Players</th><th>Favs</th></tr>";

                    top10.forEach((g, i) => {
                        html += `<tr>
                            <td>${i + 1}</td>
                            <td>${g.name || 'Unnamed'}</td>
                            <td class="ccu">${(g.ccu || 0).toLocaleString()}</td>
                            <td>‚òÖ ${(g.favourites || 0).toLocaleString()}</td>
                        </tr>`;
                    });

                    html += "</table>";
                    document.getElementById('leaderboard').innerHTML = html;
                    return; // EXIT loop once we successfully get data!

                } catch (err) {
                    console.warn(`Proxy ${proxy} failed, trying next...`);
                }
            }

            document.getElementById('leaderboard').innerHTML = "All proxies blocked. Retrying in 20s...";
            setTimeout(updateLeaderboard, 20000);
        }

        updateLeaderboard();
    </script>
</body>
</html>
